<div class="flex flex-col min-h-screen">
  <!-- 根据showHeader属性决定是否显示header -->
  @if (showHeader()) {
    <app-mini-header class="mb-6"></app-mini-header>
  }

  <div class="main-container flex flex-col md:flex-row flex-grow px-4 py-6 gap-6 max-w-7xl mx-auto w-full">
    <!-- 侧边栏 -->
    @if (getCurrentTheme()) {
      <div class="sidebar-container hidden md:block md:w-64 lg:w-80 flex-shrink-0">
        <app-article-sidebar [apiTheme]="getCurrentTheme()" class="sticky top-24"></app-article-sidebar>
      </div>
    }

    <!-- 文章内容区域 -->
    <div class="content-area flex-grow">
      <!-- 页面加载状态 -->
      @if (loading) {
        <div class="content-wrapper">
          <div class="flex justify-center items-center h-64">
            <i class="pi pi-spin pi-spinner text-3xl"></i>
          </div>
        </div>
      }

      <!-- 错误状态 -->
      @if (error && !loading) {
        <div class="content-wrapper">
          <div class="article-container">
            <p-card class="article-card">
              <div class="text-center py-8 px-4">
                <i class="pi pi-exclamation-triangle text-5xl text-red-500 mb-4 block"></i>
                <h2 class="text-2xl font-bold mb-2">出错了</h2>
                <p class="mb-6 text-gray-600 dark:text-gray-300">{{ error }}</p>
                <p-button label="返回首页" icon="pi pi-home" (onClick)="goBack()" styleClass="p-button-outlined"></p-button>
              </div>
            </p-card>
          </div>
        </div>
      }

      <!-- 文章内容 -->
      @if (article && !loading && !error) {
        <div class="content-wrapper">
          <div class="article-container">
            <p-card class="article-card">
              <!-- 文章标题 -->
              <div class="mb-4">
                <h1 class="article-title text-3xl font-bold mb-4">{{ article.title }}</h1>
                <div class="article-meta flex flex-wrap gap-4 text-gray-600 dark:text-gray-300">
                  <span class="meta-item flex items-center gap-1">
                    <i class="pi pi-calendar"></i>
                    {{ article.inserted_at | date: 'yyyy-MM-dd HH:mm' }}
                  </span>
                  <span class="meta-item flex items-center gap-1">
                    <i class="pi pi-folder"></i>
                    默认分类
                  </span>
                </div>
              </div>

              <p-divider class="article-divider my-6"></p-divider>

              <!-- 文章内容 -->
              <div class="prose max-w-none dark:prose-invert">
                <app-markdown-viewer
                  [markdownText]="article.s3_content">
                </app-markdown-viewer>
              </div>

              <p-divider class="article-divider my-6"></p-divider>

              <!-- 文章操作 -->
              <div class="article-actions flex flex-col sm:flex-row justify-between items-start sm:items-center mt-6 gap-4">
                <p-button label="返回" icon="pi pi-arrow-left" (onClick)="goBack()" styleClass="p-button-outlined"></p-button>
                <div class="action-buttons flex gap-2">
                  <p-button icon="pi pi-heart" styleClass="p-button-outlined p-button-secondary"></p-button>
                  <p-button icon="pi pi-share-alt" styleClass="p-button-outlined p-button-secondary"></p-button>
                  <p-button icon="pi pi-bookmark" styleClass="p-button-outlined p-button-secondary"></p-button>
                </div>
              </div>
            </p-card>
          </div>
        </div>
      }
    </div>
  </div>
</div>

@if (showHeader()) {
  <app-simple-footer></app-simple-footer>
}

<router-outlet></router-outlet>
